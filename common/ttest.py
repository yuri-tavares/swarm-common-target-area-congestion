import math
from scipy.stats import t

def testTEqual(means1, variances1, n1, means2, variances2, n2, alpha=0.01):
  '''
    means1, means2: vector
    variances1, variances2: vector
    n1,n2: integer
    alpha: one minus confidence level
    return True if p-value >= alpha, that is, means are equal.
  '''
  l1,l2 = len(means1),len(means2)
  df = n1 + n2 - 2
  ts = [(means1[i] - means2[i])/math.sqrt(variances1[i]/n1 + variances2[i]/n2) for i in range(min(l1,l2))]
  ps = [(1-t.cdf(abs(ts[i]),df))*2 for i in range(min(l1,l2))]
  return [(ps[i] >= alpha, ps[i]) for i in range(min(l1,l2))]


# Snippet for getting throughputs. Insert it below plt.errorbar.
'''
      if algorithmsLabels[a] in  ["SQF","EE","TRVF"]:
        print('#',end='')
        print(algorithmsLabels[a],suffix_file,sep='-------')
        print('means'+algorithmsLabels[a]+' = ',end='')
        print(*dataMean[:,a,fileline,i_sf], sep=', ')
        print('vari'+algorithmsLabels[a]+' = ',end='')
        print(*dataVari[:,a,fileline,i_sf], sep=', ')
'''


n1 = n2 = 40
nR = tuple(range(20,301,20))

'''-------------------------------------------------'''
'''------------------- Throughput ------------------'''
'''-------------------------------------------------'''
#EE-------nonholo
meansEE = 0.2729346247516843, 0.31341034518761635, 0.359801830154823, 0.3648337943521162, 0.3748422361295326, 0.3693687130635658, 0.3717829501337965, 0.36018159627813684, 0.3618513488657092, 0.36914751012612224, 0.3596080371136698, 0.35798277973283976, 0.3510300927750557, 0.34969116804787903, 0.34681474090872455
variEE = 0.0016234482321003524, 0.0016443087963273714, 0.00141307112245652, 0.0012276675543365582, 0.0010387868292804476, 0.0007402302320167991, 0.0007398429997989007, 0.0006491423615254857, 0.0007012311023910911, 0.0007090245405580519, 0.0003644395377617014, 0.0007741739735836354, 0.0005314822101333417, 0.0005240465822750782, 0.00029898928911479053
#TRVF-------nonholo
meansTRVF = 0.20136274278734606, 0.26572134259152047, 0.2863747608678278, 0.28686694717928274, 0.2739064836602529, 0.2863898885657445, 0.27687918883321055, 0.28018600567297625, 0.28945959789210923, 0.27891031882867556, 0.27920698238847486, 0.27151922778031146, 0.27480245546827026, 0.26978217576025443, 0.2667555183607752
variTRVF = 0.0008217640961276524, 0.000883657264208967, 0.00164188260906163, 0.001291220310218862, 0.0012262800535867066, 0.0010625075889300988, 0.0010144802383956146, 0.0006829506820934588, 0.0008264726489398243, 0.000320735835068952, 0.000361983371109722, 0.0004468486537674137, 0.00022201689583841843, 0.00036493519780208525, 0.00018507698423779416
#SQF-------nonholo
meansSQF = 0.11461587066405694, 0.20187884987433408, 0.2768090848959474, 0.34440002907664313, 0.39572238381985203, 0.4261673774285784, 0.44299181697201623, 0.4528351061710749, 0.4591061415758781, 0.46761140444916266, 0.476071195869822, 0.48140938222942287, 0.484860753248169, 0.4916729799608247, 0.49604071070192435
variSQF = 5.99981282732865e-05, 6.919472001973702e-05, 0.00010563343316969659, 0.00015218117156074124, 0.00013189399236605194, 0.00011730420059507962, 0.0001240642063897755, 8.457404192010536e-05, 6.884906724957584e-05, 6.563253864473893e-05, 0.00011012815592905049, 4.268060067442068e-05, 5.871595646334402e-05, 4.745863859857202e-05, 5.176667927014646e-05

nRvalue = 100
i = nR.index(nRvalue)
print("th nonholo ",nRvalue," SQF EE")
print(testTEqual([meansEE[i]], [variEE[i]], n1, [meansSQF[i]], [variSQF[i]], n2))

nRvalue = 60
i = nR.index(nRvalue)
print("th nonholo ",nRvalue," SQF TRVF")
print(testTEqual([meansTRVF[i]], [variTRVF[i]], n1, [meansSQF[i]], [variSQF[i]], n2))

nRvalue = 40
i = nR.index(nRvalue)
print("th nonholo ",nRvalue," SQF TRVF")
print(testTEqual([meansTRVF[i]], [variTRVF[i]], n1, [meansSQF[i]], [variSQF[i]], n2))

#EE-------holo
meansEE = 0.3278386494219313, 0.46737177826035553, 0.5078957183514813, 0.562957032518307, 0.5778458507908205, 0.5963269229484884, 0.6119592592130421, 0.6025958792799867, 0.6219326224937499, 0.6318462097346238, 0.6294878627238548, 0.6353209271096542, 0.6434460718689131, 0.6336143957830069, 0.6338316439215679
variEE = 0.0028893877949456174, 0.003013097367793725, 0.0028833644103494873, 0.0023612784214373907, 0.0032503994326052157, 0.0018052035763632189, 0.0016670993772566795, 0.0010570426630176182, 0.0012906761109160063, 0.000937206380376979, 0.001177446927398422, 0.0015214721920385377, 0.0008216311436172484, 0.00118339024598461, 0.0006947750580423063
#TRVF-------holo
meansTRVF = 0.2586654336152572, 0.3891512311454397, 0.4481129132463145, 0.4815830957259946, 0.4854598839086748, 0.4988693085704362, 0.5074658013323802, 0.5207317652490134, 0.5136930031117631, 0.5155551400792188, 0.5147033799826551, 0.5058718214005863, 0.4909450112852701, 0.4950290729948092, 0.4870254078995462
variTRVF = 0.0003440953080127987, 0.0014864850410976126, 0.0026246854745365445, 0.0019216854299060782, 0.001381390043540337, 0.0006406699484977662, 0.0009065633551650012, 0.001473948716007883, 0.0011410395243377195, 0.0014016216576373142, 0.0012545463717931762, 0.0008227198082041707, 0.0005797745789961783, 0.0007475365448211292, 0.0008465781014825818
#SQF-------holo
meansSQF = 0.11990791070951454, 0.2230945481862173, 0.31144572079367555, 0.3786935493541188, 0.43386721019350905, 0.48271901752881563, 0.5162363851249581, 0.5418154494555516, 0.5702401205882259, 0.5975018728379851, 0.6286003127252433, 0.6512966597754737, 0.6673861406467506, 0.6803188512611048, 0.6951064387522147
variSQF = 9.789439436452566e-05, 0.00012981708825555156, 0.00012213333686271005, 0.00020911048189628038, 0.00024214761892708725, 0.0001591196775957792, 0.00014864737499778626, 0.00025031551469385636, 0.00013508126933191937, 0.0001573359582758006, 0.0001250563039127579, 8.024439185931313e-05, 0.00010161547024076989, 9.786803655887975e-05, 0.00011569375847865764

nRvalue = 240
i = nR.index(nRvalue)
print("th holo ",nRvalue," SQF EE")
print(testTEqual([meansEE[i]], [variEE[i]], n1, [meansSQF[i]], [variSQF[i]], n2))


'''--------------------------------------------------'''
'''------------------- Total time  ------------------'''
'''--------------------------------------------------'''

#EE-------nonholo
meansEE = 173.77, 226.5625, 265.34250000000003, 318.4925, 360.9125, 423.0575, 474.2075, 541.01, 594.1975, 639.89, 706.625, 769.01, 838.0575000000001, 895.7875, 959.9200000000001
variEE = 129.02060000000003, 339.1268437500001, 279.78444375, 357.8791937500001, 516.2435937500001, 674.18394375, 649.7801937500002, 1011.2888999999999, 1393.8342437499996, 1611.1764, 982.5713749999998, 2678.3099000000007, 2440.7214437500006, 2419.3795937500004, 1714.7930999999996
#TRVF-------nonholo
meansTRVF = 205.60249999999996, 254.30750000000003, 318.58500000000004, 385.335, 473.32750000000004, 530.415, 614.39, 680.8599999999999, 742.045, 829.0350000000001, 904.61, 995.7674999999999, 1056.1799999999998, 1155.1575, 1226.9675
variTRVF = 236.15024375000002, 264.6626937500001, 1065.8627750000003, 1461.783275, 1968.95849375, 2224.7507750000004, 3578.872399999999, 2564.8163999999997, 2392.2754749999995, 1650.8852750000005, 1490.5439000000001, 3760.627193750001, 2060.817600000002, 3730.7729437500006, 2946.05569375
#SQF-------nonholo
meansSQF = 288.87, 308.64, 325.64750000000004, 342.91999999999996, 365.1925, 395.73, 429.8175000000001, 467.21000000000004, 505.81499999999994, 540.6375, 577.88, 611.5925, 650.9300000000001, 681.8774999999999, 719.4025
variSQF = 80.54409999999999, 59.91039999999991, 43.75099374999998, 43.206099999999964, 48.50869374999994, 92.30259999999997, 77.83544375, 70.48440000000005, 83.97427500000005, 76.57184375000001, 119.16159999999998, 84.55069375000008, 113.90809999999985, 77.1367437500001, 101.68224374999993

nRvalue = 80
i = nR.index(nRvalue)
print("totaltime nonholo ",nRvalue," SQF EE")
print(testTEqual([meansEE[i]], [variEE[i]], n1, [meansSQF[i]], [variSQF[i]], n2))

nRvalue = 100
i = nR.index(nRvalue)
print("totaltime nonholo ",nRvalue," SQF EE")
print(testTEqual([meansEE[i]], [variEE[i]], n1, [meansSQF[i]], [variSQF[i]], n2))

nRvalue = 120
i = nR.index(nRvalue)
print("totaltime nonholo ",nRvalue," SQF EE")
print(testTEqual([meansEE[i]], [variEE[i]], n1, [meansSQF[i]], [variSQF[i]], n2))

#EE-------holo
meansEE = 158.945, 182.2, 215.2775, 238.7325, 267.41, 296.84749999999997, 324.71000000000004, 358.20500000000004, 383.2875, 408.05, 441.88, 473.02, 496.76000000000005, 535.25, 567.6475
variEE = 81.90647499999993, 121.47049999999997, 152.90124375, 174.06369375000006, 305.98939999999993, 237.25649375000003, 207.70490000000004, 285.41147500000005, 289.31109375000005, 235.11349999999993, 329.4191, 581.8756000000001, 294.3934000000002, 532.0185, 446.9454937499997
#TRVF-------holo
meansTRVF = 172.03000000000003, 201.5375, 235.85500000000002, 268.0775, 307.7525, 340.0125, 377.04499999999996, 406.5, 449.19500000000005, 487.0775, 529.515, 571.1825000000001, 626.6975, 661.9925, 713.845
variTRVF = 41.54259999999997, 145.49234375000006, 273.815475, 230.07224375000004, 299.41649375000014, 167.14759375, 375.3144750000001, 387.9694999999999, 538.2719750000001, 855.7497437500003, 966.986775, 691.9034437500001, 586.9832437499999, 876.9901937500002, 1241.7809750000001
#SQF-------holo
meansSQF = 279.48249999999996, 290.225, 301.50750000000005, 321.6575, 340.62749999999994, 357.46999999999997, 379.975, 404.15500000000003, 424.325, 443.61, 459.1625, 477.425, 498.445, 519.735, 539.6725
variSQF = 96.11794375000002, 53.096374999999966, 37.85369374999998, 36.324443749999986, 68.80299375, 38.147100000000066, 40.88937500000001, 63.860474999999994, 32.84837499999999, 45.588399999999965, 45.23634375, 26.121374999999965, 36.641975000000016, 35.117774999999945, 40.66899375000001

nRvalue = 240
i = nR.index(nRvalue)
print("total time holo ",nRvalue," SQF EE")
print(testTEqual([meansEE[i]], [variEE[i]], n1, [meansSQF[i]], [variSQF[i]], n2))

nRvalue = 260
i = nR.index(nRvalue)
print("total time holo ",nRvalue," SQF EE")
print(testTEqual([meansEE[i]], [variEE[i]], n1, [meansSQF[i]], [variSQF[i]], n2))

nRvalue = 280
i = nR.index(nRvalue)
print("total time holo ",nRvalue," SQF EE")
print(testTEqual([meansEE[i]], [variEE[i]], n1, [meansSQF[i]], [variSQF[i]], n2))


'''-----------------------------------------------------'''
'''------------------- Reaching time  ------------------'''
'''-----------------------------------------------------'''

#EE-------nonholo
meansEE = 113.55, 167.17249999999999, 205.95999999999998, 257.66, 304.125, 361.46, 412.925, 480.515, 533.64, 577.8275, 646.415, 706.9925000000001, 776.2149999999999, 835.8875, 899.3225
variEE = 129.2135, 275.80049375, 346.39639999999997, 443.87789999999984, 511.0428750000001, 592.3364000000003, 739.5183750000001, 948.4017749999999, 1314.1113999999995, 1484.7234937499998, 1067.8872749999996, 2817.03319375, 2390.0507750000006, 2582.0925937500006, 1811.0422437499997
#TRVF-------nonholo
meansTRVF = 149.69750000000002, 200.445, 261.35749999999996, 330.00750000000005, 414.9175, 469.525, 557.575, 620.3599999999999, 673.1850000000001, 764.475, 835.8849999999999, 932.9325000000001, 992.51, 1087.1950000000002, 1171.1775000000002
variTRVF = 189.35474375000004, 288.982975, 1170.38394375, 1464.5446937500005, 2196.95144375, 2653.133375, 4080.931375, 3092.7333999999996, 3808.5742750000004, 2253.3343749999995, 2773.942275000001, 4832.761693750002, 2593.8043999999986, 5524.897974999998, 3238.6877437499998
#SQF-------nonholo
meansSQF = 221.59750000000003, 241.39499999999998, 258.3125, 274.65500000000003, 295.005, 323.5775, 357.7875, 394.58500000000004, 433.3974999999999, 468.58500000000004, 503.35, 539.4125000000001, 577.2375, 609.9375, 645.3275
variSQF = 82.87974375000002, 60.956975000000035, 48.05659374999997, 60.90647499999994, 47.435475000000075, 45.88824374999994, 66.09959375000005, 50.42077500000003, 49.90524375, 58.59027499999996, 108.49750000000002, 47.201093749999934, 81.1313437500001, 68.12584374999999, 79.0949937499999

for i,nRvalue in enumerate(nR):
  print("reaching time nonholo ",nRvalue," SQF TRVF")
  print(testTEqual([meansTRVF[i]], [variTRVF[i]], n1, [meansSQF[i]], [variSQF[i]], n2))

nRvalue = 80
i = nR.index(nRvalue)
print("reaching time nonholo ",nRvalue," SQF EE")
print(testTEqual([meansEE[i]], [variEE[i]], n1, [meansSQF[i]], [variSQF[i]], n2))

nRvalue = 100
i = nR.index(nRvalue)
print("reaching time nonholo ",nRvalue," SQF EE")
print(testTEqual([meansEE[i]], [variEE[i]], n1, [meansSQF[i]], [variSQF[i]], n2))

nRvalue = 120
i = nR.index(nRvalue)
print("reaching time nonholo ",nRvalue," SQF EE")
print(testTEqual([meansEE[i]], [variEE[i]], n1, [meansSQF[i]], [variSQF[i]], n2))

#EE-------holo
meansEE = 101.75, 125.475, 157.45999999999998, 180.435, 210.99499999999998, 238.18249999999998, 264.86, 300.5575, 324.3025, 351.00249999999994, 384.015, 412.36499999999995, 437.74500000000006, 475.88, 506.7375
variEE = 107.5895, 111.26687499999998, 174.50790000000003, 155.843275, 297.66047499999996, 215.8974437500001, 225.0664, 211.20544375, 301.93124375000014, 245.03424375000014, 383.455775, 584.1302749999999, 325.4839750000001, 584.9655999999999, 393.83184374999985
#TRVF-------holo
meansTRVF = 125.65, 148.8725, 179.5925, 211.695, 250.3675, 284.175, 319.9, 351.46999999999997, 394.34000000000003, 432.66499999999996, 471.785, 517.98, 573.025, 609.6274999999999, 660.4625
variTRVF = 39.822500000000005, 106.49299374999995, 256.78719375, 216.91197499999998, 241.45069375000003, 145.40187500000005, 301.80449999999985, 531.5336, 522.8594000000003, 912.5347749999997, 1001.2242749999999, 710.8471000000001, 703.131375, 1007.1274937499996, 1448.1648437500003
#SQF-------holo
meansSQF = 212.70749999999998, 222.8225, 234.4875, 254.0275, 272.7725, 290.0, 312.58000000000004, 336.6525, 356.5425, 375.71, 391.1375, 409.5825, 430.41499999999996, 452.02250000000004, 472.12749999999994
variSQF = 99.49969375000003, 48.16024375000001, 36.430093750000005, 48.56999374999999, 75.16999374999997, 38.47150000000001, 40.32060000000005, 72.02549374999998, 35.35744374999998, 49.5139, 41.703843750000004, 26.859943750000024, 36.94027500000003, 36.159243749999995, 42.050993749999996

nRvalue = 240
i = nR.index(nRvalue)
print("reaching time holo ",nRvalue," SQF EE")
print(testTEqual([meansEE[i]], [variEE[i]], n1, [meansSQF[i]], [variSQF[i]], n2))

nRvalue = 260
i = nR.index(nRvalue)
print("reaching time holo ",nRvalue," SQF EE")
print(testTEqual([meansEE[i]], [variEE[i]], n1, [meansSQF[i]], [variSQF[i]], n2))

nRvalue = 280
i = nR.index(nRvalue)
print("reaching time holo ",nRvalue," SQF EE")
print(testTEqual([meansEE[i]], [variEE[i]], n1, [meansSQF[i]], [variSQF[i]], n2))

for i,nRvalue in enumerate(nR):
  print("reaching time holo ",nRvalue," SQF TRVF")
  print(testTEqual([meansTRVF[i]], [variTRVF[i]], n1, [meansSQF[i]], [variSQF[i]], n2))
